version: v1.0
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: "Build and test"
    task:
      prologue:
        commands:
          - checkout
          - cache restore "m2-$(checksum GAE/pom.xml)"
      epilogue:
        commands:
          - cache store "m2-$(checksum GAE/pom.xml)" "$HOME/.m2"
      jobs:
        - name: Build and test
          commands:
            - checkout
            - ./ci/bootstrap-build.sh /app/src/ci/build.sh
