/*
 *  Copyright (C) 2022 Stichting Akvo (Akvo Foundation)
 *
 *  This file is part of Akvo FLOW.
 *
 *  Akvo FLOW is free software: you can redistribute it and modify it under the terms of
 *  the GNU Affero General Public License (AGPL) as published by the Free Software Foundation,
 *  either version 3 of the License or any later version.
 *
 *  Akvo FLOW is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY;
 *  without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 *  See the GNU Affero General Public License included below for more details.
 *
 *  The full license text can also be seen at <http://www.gnu.org/licenses/agpl.html>.
 */

package org.waterforpeople.mapping.dataexport;

import org.apache.poi.ss.SpreadsheetVersion;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

class GraphicalSurveySummaryExporterTests {

    private static final String VERY_LARGE_GEOSHAPE = "{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[16.588926315307617,45.79546169865376],[16.60529851913452,45.5976597760644],[16.60856008529663,45.5976898036018],[16.610963344573975,45.597614734728126],[16.61210060119629,45.59756969335572],[16.61358118057251,45.597554679556865],[16.613752841949463,45.59753966575404],[16.61559820175171,45.597494624321364],[16.616520881652832,45.59750963813627],[16.617143154144287,45.597329472092234],[16.61735773086548,45.59717933328033],[16.617271900177002,45.59663883023126],[16.617121696472168,45.59591815140062],[16.61607027053833,45.59584308015681],[16.615405082702637,45.59584308015681],[16.6148042678833,45.59582806589599],[16.61454677581787,45.59578302308946],[16.614267826080322,45.59576800881258],[16.613645553588867,45.59578302308946],[16.613194942474365,45.59578302308946],[16.612765789031982,45.59573798024675],[16.612486839294434,45.59570795166487],[16.611521244049072,45.59573798024675],[16.61004066467285,45.59575299453167],[16.608452796936035,45.59578302308946],[16.607508659362793,45.59578302308946],[16.60656452178955,45.59579803736232],[16.605534553527832,45.59584308015681],[16.604633331298828,45.59588812291514],[16.604139804840088,45.595903137159894],[16.602895259857178,45.59594817987001],[16.602702140808105,45.59593316563732],[16.6018009185791,45.59584308015681],[16.601672172546387,45.59564789445292],[16.60184383392334,45.59534760742896],[16.60261631011963,45.59486714484836],[16.60283088684082,45.59476204311053],[16.6033673286438,45.5947320140064],[16.604633331298828,45.594686970320105],[16.605513095855713,45.59467195575],[16.606135368347164,45.59462691201549],[16.606993675231934,45.59458186824482],[16.609439849853516,45.5945218098277],[16.61062002182007,45.59447676597268],[16.61310911178589,45.59449178059505],[16.6137957572937,45.5945067952134],[16.61557674407959,45.5945218098277],[16.61579132080078,45.594536824438],[16.617422103881836,45.5945067952134],[16.617743968963623,45.59422151677801],[16.617980003356934,45.59387617778438],[16.617937088012695,45.59357588127995],[16.61733627319336,45.59332062798776],[16.616413593292233,45.593170478450055],[16.61501884460449,45.59309540353055],[16.61386013031006,45.59302032851063],[16.61306619644165,45.59291522331399],[16.612014770507812,45.59302032851063],[16.60999774932861,45.59293023835412],[16.609182357788082,45.59294525339027],[16.608474254608154,45.59294525339027],[16.607165336608887,45.59296026842237],[16.605899333953857,45.59291522331399],[16.60454750061035,45.59294525339027],[16.60332441329956,45.59297528345044],[16.602251529693604,45.59294525339027],[16.60130739212036,45.59296026842237],[16.60057783126831,45.592840148053035],[16.600449085235596,45.592689997229826],[16.60055637359619,45.5917740685091],[16.60104990005493,45.59117345139722],[16.601157188415527,45.59102329611495],[16.602637767791748,45.590978249451936],[16.604268550872803,45.590993265010276],[16.604397296905518,45.590978249451936],[16.606285572052002,45.59088815601744],[16.607251167297363,45.59084310924596],[16.609203815460205,45.590768031213145],[16.61083459854126,45.590737999971914],[16.61147832870483,45.590602859187484],[16.612122058868408,45.59030254516818],[16.612250804901123,45.5901974348818],[16.612122058868408,45.58967188049731],[16.612014770507812,45.58937156149672],[16.611456871032715,45.589281465483204],[16.611070632934567,45.589281465483204],[16.610383987426758,45.589281465483204],[16.60935401916504,45.58926644946689],[16.609010696411133,45.5892964814955],[16.608409881591797,45.5892964814955],[16.60755157470703,45.58923641742223],[16.606478691101074,45.58923641742223],[16.605491638183594,45.58920638536148],[16.60454750061035,45.58917635328465],[16.6033673286438,45.58920638536148],[16.601951122283936,45.58922140139385],[16.601436138153076,45.58922140139385],[16.601157188415527,45.58911628908283],[16.60111427307129,45.58887603163272],[16.601200103759766,45.588470594853746],[16.60182237625122,45.58771977827069],[16.602659225463867,45.58698396827562],[16.602938175201416,45.58683380178545],[16.604204177856445,45.58672868500329],[16.60634994506836,45.58671366830407],[16.60770177841186,45.586773735076896],[16.609697341918945,45.58690888508076],[16.61180019378662,45.58732934967854],[16.613173484802246,45.586503434093],[16.612701416015625,45.58584269287515],[16.61085605621338,45.58539218304027],[16.60935401916504,45.585317097716306],[16.607980728149414,45.5852570293848],[16.607508659362793,45.5852570293848],[16.606392860412598,45.58521197809398],[16.605405807495117,45.58516692676703],[16.60510540008545,45.58483654926462],[16.605277061462402,45.584611290761835],[16.605470180511475,45.584220840549214],[16.60585641860962,45.583920492383875],[16.605985164642334,45.58389045747895],[16.607186794281006,45.5838153701464],[16.607530117034912,45.583770317698644],[16.608645915985107,45.58378533518524],[16.609375476837158,45.58378533518524],[16.611199378967285,45.58386042255797],[16.612873077392578,45.58378533518524],[16.614890098571777,45.583424914398066],[16.61583423614502,45.582839225683784],[16.615726947784424,45.58211836964752],[16.615254878997803,45.5818029922212],[16.613988876342773,45.581742920129614],[16.612980365753174,45.58166782992474],[16.61203622817993,45.58171288405972],[16.61147832870483,45.58166782992474],[16.609096527099606,45.58165281187173],[16.607744693756104,45.58166782992474],[16.606242656707764,45.581938154192265],[16.605191230773926,45.58195317216897],[16.604397296905518,45.58187808224529],[16.60433292388916,45.58168284797377],[16.604290008544922,45.58109714108569],[16.60435438156128,45.58085684931277],[16.60456895828247,45.580271133807784],[16.6048264503479,45.57985061634377],[16.60510540008545,45.5794150770787],[16.605405807495117,45.57905462823541],[16.60604953765869,45.57851395063191],[16.606693267822266,45.57779303906188],[16.607186794281006,45.577432579806],[16.60780906677246,45.57698200248222],[16.6083025932312,45.57683180923751],[16.610083580017086,45.57633616867975],[16.61062002182007,45.57617095418837],[16.612722873687744,45.57605079788929],[16.614911556243896,45.5764713438112],[16.616177558898926,45.57738752223633],[16.618173122406006,45.57795824878083],[16.61931037902832,45.578904440534465],[16.619889736175537,45.57921983424247],[16.620254516601562,45.57731242620651],[16.620404720306396,45.576681615591085],[16.620855331420895,45.576155934665024],[16.62156343460083,45.575870562958656],[16.621735095977783,45.57493933993476],[16.622872352600098,45.57486424063091],[16.62435293197632,45.57472906163092],[16.624760627746582,45.57427846261416],[16.625511646270752,45.574233402513656],[16.626262664794922,45.57501443913816],[16.627378463745117,45.575510091361885],[16.6278076171875,45.575885582558286],[16.62806510925293,45.57717725309976],[16.62855863571167,45.578619082795896],[16.629931926727295,45.57953522617892],[16.630253791809082,45.578063381985295],[16.6318416595459,45.57752269483689],[16.632120609283447,45.57741756062012],[16.63276433944702,45.577342464630476],[16.63355827331543,45.577237330076265],[16.634094715118408,45.57720729159604],[16.63452386856079,45.57719227234991],[16.635854244232178,45.5772974069885],[16.63604736328125,45.577282387766466],[16.63703441619873,45.57735748383643],[16.637699604034424,45.57735748383643],[16.63857936859131,45.57735748383643],[16.639952659606934,45.57761280972318],[16.641325950622555,45.57782307722876],[16.642441749572754,45.57834874254794],[16.643493175506592,45.579204815534645],[16.64424419403076,45.57944511437787],[16.64456605911255,45.57980556071442],[16.644222736358643,45.58036124428318],[16.643621921539303,45.58063157484164],[16.643171310424805,45.58069164812231],[16.64254903793335,45.581022050017104],[16.64254903793335,45.581232304756014],[16.642441749572754,45.58156270346922],[16.642162799835205,45.58202826199221],[16.642098426818848,45.582148405500476],[16.64175510406494,45.58226854875166],[16.641132831573486,45.58243374530227],[16.640961170196533,45.58267403032631],[16.640896797180176,45.582839225683784],[16.640467643737793,45.58319965023104],[16.64005994796753,45.58330477362148],[16.639759540557858,45.583454949552035],[16.639845371246334,45.58393550983032],[16.64003849029541,45.58428090998946],[16.640210151672363,45.58452118710766],[16.64029598236084,45.584701394271434],[16.640489101409912,45.58498672109766],[16.640660762786865,45.585317097716306],[16.64076805114746,45.585437234186465],[16.640875339508057,45.58578262510607],[16.640939712524414,45.585857709807385],[16.641089916229248,45.58632323271399],[16.64154052734375,45.58666861818227],[16.641712188720703,45.58734436621305],[16.641883850097656,45.58762967960584],[16.641969680786133,45.58771977827069],[16.642119884490967,45.58802010610908],[16.642313003540036,45.588305416067165],[16.64250612258911,45.588545675959686],[16.642656326293945,45.58875590252204],[16.642849445343018,45.58892107998296],[16.642978191375732,45.58910127302232],[16.644179821014404,45.58970191230898],[16.644136905670166,45.59118846690332],[16.644179821014404,45.59174403780615],[16.64426565170288,45.59216446618507],[16.644372940063477,45.5924948005591],[16.64454460144043,45.59291522331399],[16.64469480514526,45.593215523353535],[16.64478063583374,45.59362092585805],[16.644845008850098,45.59371101490579],[16.645081043243408,45.59426656083791],[16.645123958587646,45.59495723189556],[16.645231246948242,45.59593316563732],[16.645359992980957,45.59633854850995],[16.645402908325195,45.59644364729521],[16.64551019668579,45.59678897048935],[16.645832061767578,45.59758470715054],[16.645832061767578,45.597809913590794],[16.64604663848877,45.59875577076982],[16.646089553833004,45.5989659590888],[16.64604663848877,45.599671585543916],[16.64851427078247,45.6012329401999],[16.650037765502926,45.60196856339303],[16.651668548583984,45.602478990144576],[16.65205478668213,45.60289933810014],[16.652183532714844,45.60336471966302],[16.65278434753418,45.60414535103496],[16.653857231140137,45.60367997594771],[16.655681133270264,45.6048959478797],[16.65580987930298,45.60500103063652],[16.656196117401123,45.60560149975669],[16.65778398513794,45.6062169739344],[16.658256053924557,45.60771810214468],[16.658685207366943,45.608723835571794],[16.658856868743896,45.609069083187556],[16.659157276153564,45.60941432867828],[16.65926456451416,45.6095494241614],[16.660466194152832,45.61181597762924],[16.660466194152832,45.612041126945925],[16.660380363464355,45.6131818695927],[16.66104555130005,45.61433759834838],[16.66123867034912,45.615058040586334],[16.661345958709717,45.61568841995221],[16.661345958709717,45.616258757082036],[16.661410331726074,45.61649889729606],[16.66171073913574,45.617189294682966],[16.66175365447998,45.617294354409715],[16.662161350250244,45.61808980023935],[16.6622257232666,45.61860008030201],[16.66224718093872,45.618720145524236],[16.662290096282955,45.6191103557209],[16.662375926971436,45.61960561859835],[16.664950847625732,45.61965064227938],[16.665401458740234,45.61950056320201],[16.66825532913208,45.61980072095504],[16.670658588409424,45.621361515368505],[16.671817302703857,45.622712167772605],[16.672868728637695,45.62319239189717],[16.673812866210938,45.62388270686962],[16.6742205619812,45.624422947440564],[16.675121784210205,45.62508323440172],[16.67670965194702,45.62554843190904],[16.677589416503906,45.62581854481918],[16.678190231323242,45.62620870561387],[16.67846918106079,45.62652383350405],[16.678876876831055,45.626733917780015],[16.679198741912842,45.62736416588381],[16.6792631149292,45.627919378580486],[16.681087017059326,45.628744684588064],[16.681172847747803,45.628894738920266],[16.6827392578125,45.62976504612542],[16.684563159942623,45.63059032495763],[16.68494939804077,45.63132556313632],[16.68424129486084,45.63207579623364],[16.683640480041504,45.632480917930465],[16.68376922607422,45.63267597548081],[16.684348583221436,45.63315611425089],[16.6847562789917,45.633441194699365],[16.685185432434082,45.63393633097908],[16.68546438217163,45.63411637945071],[16.685936450958252,45.63498660557578],[16.68651580810547,45.635961842933675],[16.68696641921997,45.63720712134883],[16.68771743774414,45.63755219360326],[16.688661575317383,45.63795727571218],[16.68921947479248,45.63845237209067],[16.689326763153076,45.63872242281693],[16.689047813415527,45.63930752825893],[16.688575744628906,45.63980261270685],[16.688511371612545,45.63987762512037],[16.68848991394043,45.640177673770204],[16.688640117645264,45.64133284607053],[16.68844699859619,45.64176790478867],[16.688082218170166,45.64209794707996],[16.687932014465332,45.64235297842793],[16.68797492980957,45.64278802922453],[16.688833236694336,45.64299805253793],[16.690056324005127,45.64344809984393],[16.690678596496582,45.64397315046494],[16.69102191925049,45.64481322122318],[16.691923141479492,45.646418321391735],[16.692781448364258,45.64824837948908],[16.695034503936768,45.64803837585901],[16.696343421936035,45.648083376703156],[16.69724464416504,45.648563383457905],[16.697223186492916,45.64907338612777],[16.697115898132324,45.65019837559769],[16.697566509246826,45.6510683519609],[16.698360443115234,45.65198331252188],[16.698575019836426,45.65237329116859],[16.698811054229736,45.653168239231164],[16.700549125671387,45.65489308773277],[16.698102951049805,45.65460811642643],[16.697072982788086,45.654788098472835],[16.697072982788086,45.65586797860393],[16.698381900787354,45.65568800002818],[16.7002272605896,45.65639291281254],[16.700656414031982,45.65711281458253],[16.700570583343506,45.65750275751032],[16.700184345245358,45.6584326104567],[16.701021194458008,45.65879254938723],[16.70147180557251,45.65949742309052],[16.70170783996582,45.660082311554696],[16.702029705047607,45.66021728494798],[16.70194387435913,45.66098212803073],[16.702523231506348,45.66101212166422],[16.702630519866943,45.66117708636118],[16.70320987701416,45.661731964047455],[16.70323133468628,45.66222685031731],[16.70198678970337,45.662481790021815],[16.704347133636475,45.66339656411117],[16.70546293258667,45.66429632732243],[16.70548439025879,45.664836178307894],[16.70542001724243,45.66510610184843],[16.70522689819336,45.66537602408743],[16.704905033111572,45.665615953873946],[16.704905033111572,45.66570592727878],[16.705312728881836,45.66698053497831],[16.70569896697998,45.66728043845454],[16.70593500137329,45.66759533537528],[16.707329750061035,45.66819513413317],[16.707651615142822,45.67035435644533],[16.706664562225342,45.671059084586695],[16.706364154815674,45.671418942342854],[16.70644998550415,45.67195872463879],[16.70675039291382,45.67257347035735],[16.70696496963501,45.67275339465613],[16.707286834716797,45.67291832475524],[16.70771598815918,45.6735180664728],[16.707286834716797,45.67452261945114],[16.707158088684082,45.67570706920038],[16.708810329437256,45.676876501319256],[16.708359718322754,45.677701086198425],[16.708509922027588,45.67851066680356],[16.709089279174805,45.67902039673084],[16.71037673950195,45.679080364652286],[16.710548400878906,45.68044461750233],[16.71018362045288,45.68144904614149],[16.710011959075928,45.6816289419042],[16.710033416748047,45.682543403087735],[16.71044111251831,45.68344285852301],[16.71093463897705,45.68413243123025],[16.710762977600098,45.68470207183832],[16.71142816543579,45.68509182259654],[16.711943149566647,45.68564646322465],[16.712758541107178,45.68587131596678],[16.713509559631348,45.68603620740324],[16.714131832122803,45.686920616813104],[16.714046001434326,45.6873553213975],[16.71348810195923,45.6879399187881],[16.713058948516846,45.688674404285145],[16.713016033172607,45.68951380447219],[16.7122220993042,45.68973864166903],[16.711642742156982,45.689873543553325],[16.71147108078003,45.690203302345154],[16.711556911468506,45.69059301477443],[16.711878776550293,45.69144737482903],[16.712307929992676,45.691612249828495],[16.71290874481201,45.692196802728354],[16.713080406188965,45.69300617358031],[16.713595390319824,45.693680640342706],[16.713874340057373,45.694654855750436],[16.713745594024658,45.694939623202636],[16.714088916778564,45.69537426546554],[16.714539527893066,45.6955840915558],[16.71473264694214,45.69576394186368],[16.714882850646973,45.69603371624096],[16.715033054351807,45.69613862814732],[16.715312004089352,45.69655827380447],[16.715633869171143,45.696768095452114],[16.71591281890869,45.69678308268255],[16.716256141662598,45.69988535290494],[16.716792583465573,45.70063466773025],[16.717200279235836,45.70123411236022],[16.717329025268555,45.70148887438182],[16.71743631362915,45.70186352230473],[16.717500686645508,45.70243298233943],[16.717243194580078,45.70319724853297],[16.716749668121338,45.70373672426163],[16.71638488769531,45.70403643075037],[16.715612411499023,45.704426046783645],[16.71548366546631,45.704815660101566],[16.71299457550049,45.70483064517498],[16.7126727104187,45.705669802873736],[16.71481847763061,45.70646399409325],[16.714797019958496,45.706958484813086],[16.71481847763061,45.707842563380325],[16.71471118927002,45.70817221621625],[16.714518070220947,45.70893640394955],[16.714539527893066,45.70916116305925],[16.714260578155518,45.70958071097928],[16.714346408843994,45.71055464936717],[16.713616847991943,45.711978067252645],[16.71320915222168,45.71236762793445],[16.712565422058105,45.71275718590095],[16.712071895599365,45.71298192964645],[16.71142816543579,45.71341643165837],[16.71123504638672,45.71353629368788],[16.710956096649166,45.71374605162092],[16.71041965484619,45.71421051281382],[16.71024799346924,45.71437532069633],[16.709797382354736,45.71461504038506],[16.70966863632202,45.714839776659346],[16.709325313568115,45.71545405119784],[16.709518432617188,45.716337995391555],[16.710655689239502,45.71749159644309],[16.71093463897705,45.718854912436235],[16.709110736846924,45.71975378390609],[16.70747995376587,45.72075750662483],[16.706814765930176,45.722090782053485],[16.7067289352417,45.72268999660201],[16.706664562225342,45.723783546586034],[16.70720100402832,45.7240232259144],[16.70758724212646,45.724188004856146],[16.70745849609375,45.72439772280638],[16.706643104553223,45.72480217662995],[16.706085205078125,45.724996912611786],[16.706020832061764,45.725236586734425],[16.70621395111084,45.72552119841952],[16.707136631011963,45.725805808654584],[16.707072257995605,45.726404983357064],[16.706836223602295,45.72761829244557],[16.70720100402832,45.72826238409259],[16.707372665405273,45.72908621142071],[16.70720100402832,45.72974526453476],[16.70647144317627,45.7303743534349],[16.705334186553955,45.731332951467515],[16.703531742095947,45.73296552587026],[16.702415943145752,45.73357960113825],[16.70250177383423,45.733804261134615],[16.703381538391113,45.73372937456959],[16.704325675964355,45.73392407942985],[16.70421838760376,45.734433304316546],[16.704025268554688,45.73486763952124],[16.703789234161377,45.7355116475724],[16.703832149505615,45.73587109069712],[16.703767776489258,45.736440204246236],[16.703660488128662,45.73714409982312],[16.703810691833496,45.737803057853675],[16.703402996063232,45.73910597470679],[16.703274250030518,45.74043881221276],[16.70348882675171,45.74139723749521],[16.703510284423828,45.741636841245146],[16.703059673309326,45.74189141910276],[16.70243740081787,45.74138226222671],[16.701600551605225,45.74097792845854],[16.699905395507812,45.74142718802017],[16.699883937835693,45.74186146882682],[16.701278686523438,45.74201122004588],[16.702029705047607,45.74237062133277],[16.70196533203125,45.742715045395016],[16.701858043670654,45.742954643489476],[16.70099973678589,45.74340388714507],[16.700398921966553,45.74353865953684],[16.699841022491455,45.74422749112472],[16.699883937835693,45.74457190373142],[16.700077056884766,45.745140928600236],[16.700570583343506,45.745365542083405],[16.700677871704098,45.74572492177667],[16.700334548950195,45.746293934892726],[16.699368953704834,45.747387022763235],[16.698832511901855,45.74848008922896],[16.69947624206543,45.7486597693392],[16.69799566268921,45.75012713525657],[16.69823169708252,45.751055448873544],[16.69851064682007,45.751295011171514],[16.698768138885498,45.75177413268274],[16.69868230819702,45.752477834945424],[16.69896125793457,45.75361571770282],[16.698896884918213,45.75409481929151],[16.698832511901855,45.754678718791695],[16.69743776321411,45.75523266908037],[16.69649362564087,45.7556219281558],[16.695141792297363,45.75665494869138],[16.697030067443848,45.75652020796689],[16.698274612426758,45.75687951584256],[16.697630882263184,45.757687950103865],[16.697137355804443,45.75777777540991],[16.696815490722653,45.7584814019712],[16.696836948394775,45.75936466530732],[16.69696569442749,45.759634132694146],[16.697137355804443,45.76011318261302],[16.697051525115967,45.76036767620949],[16.69700860977173,45.76077186953566],[16.69672966003418,45.761714975909655],[16.6961932182312,45.762852670319745],[16.69645071029663,45.76283770080708],[16.696150302886963,45.7654872419868],[16.696364879608154,45.76599617899235],[16.696536540985107,45.76641530009872],[16.69651508331299,45.76705894423796],[16.69597864151001,45.76804684870164],[16.696107387542725,45.770112410588375],[16.696107387542725,45.77086078369844],[16.695613861083984,45.771669015378755],[16.694562435150146,45.771579212437096],[16.692330837249756,45.770336923575734],[16.691536903381348,45.7705764030995],[16.691172122955322,45.77190848918291],[16.691837310791016,45.77274663940003],[16.691536903381348,45.773764376301294],[16.691064834594727,45.77445283485013],[16.689906120300293,45.775081420015624],[16.687824726104736,45.77488685869771],[16.68700933456421,45.77421337197106],[16.68625831604004,45.77346504384653],[16.684541702270508,45.77382424259946],[16.685163974761963,45.77425827133919],[16.68372631072998,45.775560337290855],[16.68349027633667,45.77635353498071],[16.682395935058594,45.77711679003037],[16.681559085845947,45.7769820987219],[16.680550575256348,45.777236515364756],[16.679155826568604,45.77758072426925],[16.677825450897213,45.776622920308796],[16.67499303817749,45.77681747556975],[16.67426347732544,45.777236515364756],[16.673169136047363,45.77746099967389],[16.673641204833984,45.77629367139774],[16.672632694244385,45.77638346674811],[16.670851707458496,45.77701203015191],[16.670401096343994,45.77725148101347],[16.669843196868896,45.77750589642726],[16.669585704803467,45.77776031068027],[16.669199466705322,45.778328997166184],[16.668405532836914,45.77873306035533],[16.667611598968506,45.77886774743437],[16.665916442871094,45.77873306035533],[16.665401458740234,45.777954861972894],[16.664457321166992,45.77807458550787],[16.66325569152832,45.778463685221254],[16.662912368774414,45.77871809510425],[16.661796569824215,45.7791221554738],[16.660423278808594,45.779601038046074],[16.657869815826416,45.78046900222522],[16.657397747039795,45.780648579333935],[16.65699005126953,45.780888014579205],[16.656818389892578,45.78102269645282],[16.656389236450195,45.78130702378427],[16.655681133270264,45.78153149170592],[16.653878688812256,45.781636243093416],[16.652612686157227,45.78168113648496],[16.651690006256104,45.78160631414567],[16.650595664978027,45.78151652720594],[16.64950132369995,45.78115737800108],[16.646862030029297,45.7825490682828],[16.646604537963867,45.78311770592766],[16.646218299865723,45.78310274185342],[16.645338535308838,45.78218992572935],[16.64480209350586,45.78236949729528],[16.644587516784668,45.782863316119276],[16.64430856704712,45.78310274185342],[16.643600463867188,45.78352173441397],[16.64304256439209,45.783716265603836],[16.641604900360107,45.78383597676791],[16.640102863311768,45.78383597676791],[16.63883686065674,45.783536698375755],[16.63857936859131,45.78304288551629],[16.635854244232178,45.78325238241512],[16.6347599029541,45.78329727450529],[16.634888648986816,45.78364144599577],[16.63583278656006,45.784015543032005],[16.635103225708008,45.78546701576694],[16.63452386856079,45.78646955734186],[16.633987426757812,45.786948376806514],[16.632678508758545,45.78664911512308],[16.633493900299072,45.78569146693971],[16.632099151611328,45.78492832926514],[16.63081169128418,45.78558672317153],[16.629953384399414,45.78620021958554],[16.628708839416504,45.78645459416731],[16.62782907485962,45.78685859847019],[16.62767887115478,45.78744215507177],[16.625854969024658,45.787906003397154],[16.6247820854187,45.78774141249769],[16.622915267944336,45.78756185823492],[16.62252902984619,45.78721771094798],[16.621735095977783,45.78771148682739],[16.621241569519043,45.78814540747424],[16.620640754699707,45.788788800836485],[16.620190143585205,45.7896715842944],[16.61853790283203,45.790195262789425],[16.618173122406006,45.790210224959836],[16.617722511291504,45.790210224959836],[16.61634922027588,45.79003067864973],[16.616199016571045,45.7893573748357],[16.616241931915283,45.78871398803641],[16.615705490112305,45.78848954903366],[16.6153621673584,45.788504511661976],[16.614761352539062,45.788863613536186],[16.61428928375244,45.78937233723104],[16.614224910736084,45.79007556528148],[16.61330223083496,45.79073389839405],[16.61235809326172,45.79092840441649],[16.612250804901123,45.79053939169286],[16.611907482147217,45.79032992217858],[16.61147832870483,45.790464581242404],[16.611177921295166,45.79095832835967],[16.611521244049072,45.79157176565478],[16.61137104034424,45.79208046463215],[16.610941886901855,45.79251435126729],[16.61029815673828,45.79261908201796],[16.60905361175537,45.79230488917549],[16.60879611968994,45.79178123050187],[16.6083025932312,45.79110794783471],[16.60808801651001,45.79110794783471],[16.60770177841186,45.791347338159305],[16.60707950592041,45.79187100090966],[16.606521606445312,45.79217023455792],[16.60562038421631,45.79251435126729],[16.604526042938232,45.79236473556776],[16.603968143463135,45.791811153987204],[16.603517532348633,45.79155680384987],[16.60276651382446,45.791856039185056],[16.601994037628174,45.79426482511122],[16.600942611694336,45.79441443570978],[16.600470542907715,45.79413017522907],[16.60059928894043,45.79338211440398],[16.600277423858643,45.79293327308916],[16.599698066711426,45.793112810048875],[16.59937620162964,45.793307307769226],[16.598968505859375,45.793681339938956],[16.598711013793945,45.794010486171835],[16.59836769104004,45.79429474726306],[16.597530841827393,45.79430970833295],[16.59656524658203,45.79404040846024],[16.5958571434021,45.79366637870037],[16.59557819366455,45.79357661118449],[16.59480571746826,45.794010486171835],[16.594183444976807,45.794354591518555],[16.593518257141113,45.794579006904314],[16.592788696289062,45.79481838231974],[16.59188747406006,45.794848304174366],[16.591544151306152,45.794982952321384],[16.59083604812622,45.79513256099207],[16.590428352355957,45.79532705166348],[16.588926315307617,45.79546169865376]]]}},{\"type\":\"Feature\",\"properties\":{},\"geometry\":{\"type\":\"LineString\",\"coordinates\":[[16.61705732345581,45.600031902013306],[16.615898609161377,45.59943137327883],[16.614718437194824,45.59977667808651],[16.61630630493164,45.60067746323425]]}},{\"type\":\"Feature\",\"properties\":{},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[16.60184383392334,45.604100314904905],[16.601951122283936,45.60321459700001],[16.60306692123413,45.60268916451606],[16.60480499267578,45.602554052510484],[16.6057276725769,45.602058639039576],[16.60579204559326,45.60160825936073],[16.602487564086914,45.60087263144346],[16.599462032318115,45.60087263144346],[16.598260402679443,45.60048229434612],[16.59811019897461,45.599866757252045],[16.598389148712158,45.59952145299877],[16.600191593170166,45.599026012749576],[16.602981090545654,45.5989659590888],[16.604526042938232,45.5991611332514],[16.606414318084717,45.599731638449505],[16.608474254608154,45.6008426056093],[16.60858154296875,45.60204362644187],[16.60757303237915,45.60375503670678],[16.60607099533081,45.60440055508896],[16.601521968841553,45.605196183805575],[16.5993332862854,45.60525623079793],[16.59811019897461,45.60566154631518],[16.59534215927124,45.60878387878806],[16.59411907196045,45.608888954261865],[16.593196392059326,45.60938430741562],[16.591587066650387,45.609564434750546],[16.590685844421387,45.609744561507],[16.589698791503906,45.610375000599234],[16.589741706848145,45.61088535086472],[16.59062147140503,45.61102044280476],[16.592166423797607,45.611005432605246],[16.59409761428833,45.61087034062908],[16.59602880477905,45.610810299646324],[16.597273349761963,45.610810299646324],[16.598689556121826,45.61085533038941],[16.599805355072018,45.61087034062908],[16.600277423858643,45.61088535086472],[16.6007924079895,45.610945391767146],[16.60158634185791,45.61102044280476],[16.603388786315918,45.61109549374195],[16.604783535003662,45.61135066617721],[16.604204177856445,45.612146196317724],[16.603002548217773,45.612206235870374],[16.59909725189209,45.612131186419525],[16.596972942352295,45.612071146786526],[16.593067646026608,45.612146196317724],[16.59064292907715,45.61201110708925],[16.589291095733643,45.61196607727412],[16.587424278259277,45.61193605737729],[16.585943698883057,45.61192104742283],[16.584999561309814,45.61192104742283],[16.583240032196045,45.61184599759034],[16.60184383392334,45.604100314904905]]]}},{\"type\":\"Feature\",\"properties\":{},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[16.587982177734375,45.61363215635553],[16.578025817871094,45.66336657175507],[16.581952571868896,45.672978299216204],[16.582038402557373,45.67333814463237],[16.58212423324585,45.67386291505017],[16.582210063934326,45.67399785521938],[16.582317352294922,45.67456759901346],[16.582016944885254,45.67533224604178],[16.58208131790161,45.67557213315248],[16.579914093017575,45.67899041274601],[16.57959222793579,45.67990491705486],[16.57914161682129,45.680639508051186],[16.579055786132812,45.68111923574086],[16.579012870788574,45.68206368760938],[16.577489376068115,45.68335291363024],[16.577317714691162,45.6835328032712],[16.57714605331421,45.68404248744612],[16.576995849609375,45.6846421099422],[16.574935913085938,45.68552654139265],[16.57384157180786,45.685991237059675],[16.573820114135742,45.68716045424295],[16.573476791381836,45.688224720431776],[16.57158851623535,45.689393890931],[16.571331024169922,45.6899334998419],[16.56989336013794,45.689798598102215],[16.567704677581787,45.689633717756315],[16.567275524139404,45.68951380447219],[16.567018032073975,45.68936391250552],[16.566996574401855,45.688989180831484],[16.567533016204834,45.688194741379654],[16.567811965942383,45.6880298563059],[16.569142341613766,45.68764012601766],[16.56965732574463,45.68698057626697],[16.569013595581055,45.68665079847537],[16.568048000335693,45.686575848706134],[16.567575931549072,45.6864559288665],[16.56736135482788,45.68591628640673],[16.56764030456543,45.685481570639375],[16.567018032073975,45.68479201456201],[16.56609535217285,45.684372280614305],[16.56609535217285,45.68377265522606],[16.566331386566162,45.6832479777392],[16.566739082336426,45.682678322324904],[16.567189693450928,45.682483438877874],[16.5683913230896,45.68164393319166],[16.568305492401123,45.68123916702059],[16.567726135253906,45.68065449960377],[16.567232608795166,45.679994867490954],[16.567082405090332,45.679799974696635],[16.566781997680664,45.6796200730532],[16.56665325164795,45.67936521140149],[16.566953659057617,45.67843570612848],[16.568927764892578,45.67810587796517],[16.569507122039795,45.676846516185606],[16.56890630722046,45.67662162717099],[16.56836986541748,45.67723632166992],[16.567490100860596,45.67758114733483],[16.56641721725464,45.67746120821414],[16.565558910369873,45.677221329201494],[16.564700603485104,45.67696645662384],[16.56437873840332,45.676816531035854],[16.56412124633789,45.67663661980007],[16.563820838928223,45.676456707985835],[16.563520431518555,45.67584200492284],[16.563498973846436,45.67509235790272],[16.563541889190674,45.67411780176334],[16.56512975692749,45.67308325436826],[16.5659236907959,45.672213620024486],[16.56538724899292,45.671673840186884],[16.563713550567623,45.672213620024486],[16.563284397125244,45.671913742979626],[16.563026905059814,45.67162885829877],[16.562533378601074,45.67150890642037],[16.561696529388428,45.671478918410585],[16.560795307159424,45.67123901375399],[16.560301780700684,45.671059084586695],[16.560022830963135,45.67050429934621],[16.560430526733395,45.66943969605139],[16.561031341552734,45.66870495802411],[16.561460494995117,45.66836007766486],[16.561803817749023,45.668075174895755],[16.561996936798096,45.66764032050504],[16.561481952667236,45.66707050618989],[16.56116008758545,45.66633573706347],[16.560966968536377,45.666065819451994],[16.56060218811035,45.66632074167478],[16.560430526733395,45.66654567208376],[16.560001373291016,45.66714548208908],[16.559336185455322,45.66725044817921],[16.55912160873413,45.66723545303553],[16.55890703201294,45.66708550137776],[16.55912160873413,45.66648569072974],[16.559357643127438,45.6661258012559],[16.559507846832275,45.66546599787788],[16.558520793914795,45.66537602408743],[16.558027267456055,45.66570592727878],[16.556761264801025,45.66578090500568],[16.556010246276855,45.66527105448245],[16.555967330932617,45.66470121604961],[16.556332111358643,45.66426633544835],[16.556975841522213,45.66371148288006],[16.557984352111816,45.66330658699468],[16.55813455581665,45.662496786438865],[16.557061672210693,45.66246679360075],[16.55665397644043,45.66246679360075],[16.556203365325928,45.662451797175656],[16.55590295791626,45.662481790021815],[16.555516719818115,45.66215186783034],[16.554272174835205,45.662136871320875],[16.553950309753418,45.66201689910071],[16.553735733032227,45.661791950494965],[16.553735733032227,45.66134205057207],[16.554036140441895,45.6608471564812],[16.554272174835205,45.66059220933328],[16.55442237854004,45.6602322819716],[16.55442237854004,45.659947337836],[16.554014682769772,45.659797366655866],[16.55352115631103,45.65967738942254],[16.55289888381958,45.65961740070948],[16.55253410339355,45.65957240913251],[16.552276611328125,45.659467428645605],[16.552233695983887,45.659167483312785],[16.552276611328125,45.658912528516574],[16.552469730377197,45.65849260043916],[16.552705764770508,45.658237642569944],[16.552984714508057,45.65790769536885],[16.55302762985229,45.65741277092186],[16.552748680114746,45.65712781243768],[16.552555561065674,45.65703782524666],[16.552319526672363,45.65687284835422],[16.552104949951172,45.65670787097573],[16.55186891555786,45.656422908904396],[16.551761627197266,45.65622793402009],[16.551589965820312,45.655987963999735],[16.551504135131836,45.65568800002818],[16.551504135131836,45.65537303612877],[16.551589965820312,45.65438313805497],[16.55193328857422,45.653363224768526],[16.55268430709839,45.65235829204008],[16.553606986999508,45.651368340677024],[16.554744243621826,45.65058836667296],[16.55637502670288,45.65006337805435],[16.557512283325195,45.649433385216554],[16.558048725128174,45.648938385872945],[16.557705402374268,45.6488183853733],[16.55716896057129,45.64859338374351],[16.556460857391357,45.64844338215488],[16.55618190765381,45.648203378777474],[16.556074619293213,45.648053376144404],[16.556031703948975,45.647708368563904],[16.556074619293213,45.64724335498448],[16.55590295791626,45.64688334182014],[16.556589603424072,45.646163308550115],[16.55643939971924,45.64566828030822],[16.556525230407715,45.64535326005849],[16.55667543411255,45.645008235847584],[16.556804180145264,45.644618205919926],[16.556954383850098,45.644063158648734],[16.557383537292477,45.643388093745344],[16.55764102935791,45.64305805905427],[16.55862808227539,45.642322974800194],[16.55963659286499,45.641857916515484],[16.560516357421875,45.64155787686377],[16.561310291290283,45.641077810078876],[16.562039852142334,45.64040270920311],[16.563241481781006,45.63965258757853],[16.564464569091797,45.63905248304822],[16.56461477279663,45.637687221298286],[16.56339168548584,45.6370420860412],[16.562833786010742,45.63753719050595],[16.562533378601074,45.63801728762741],[16.561911106109616,45.63881243943647],[16.561417579650875,45.63930752825893],[16.560945510864258,45.63960757996171],[16.56060218811035,45.64014766897755],[16.559979915618896,45.64056773461283],[16.559765338897705,45.64086777956701],[16.558692455291748,45.64097279492136],[16.558027267456055,45.64082277292629],[16.557276248931885,45.640537730029024],[16.55716896057129,45.64044771618124],[16.557018756866455,45.640327697492594],[16.55686855316162,45.64013266657518],[16.556696891784668,45.63969759515922],[16.556503772735596,45.639247517725565],[16.55635356903076,45.63869241724496],[16.556460857391357,45.638092302431055],[16.556546688079834,45.637657215171934],[16.556718349456787,45.6369220600576],[16.556782722473145,45.63641194675922],[16.556954383850098,45.63570678249439],[16.557297706604004,45.635001609355974],[16.557598114013672,45.634506482488206],[16.558306217193604,45.63396633909786],[16.558756828308105,45.63365125304928],[16.5598726272583,45.63329115253884],[16.56034469604492,45.63311110141593],[16.560773849487305,45.63267597548081],[16.560945510864258,45.6320607916701],[16.56111717224121,45.631505619995586],[16.56186819076538,45.63032023504111],[16.562275886535645,45.62979505647768],[16.563069820404053,45.629029787475815],[16.564700603485104,45.62803942384588],[16.569807529449463,45.62740918333434],[16.570215225219727,45.62614868105298],[16.56809091567993,45.6261336749027],[16.566674709320065,45.627139078088746],[16.565194129943844,45.627454200748744],[16.56409978866577,45.627229113315224],[16.5637993812561,45.627139078088746],[16.563434600830078,45.62671891178641],[16.563069820404053,45.62619369947964],[16.562983989715576,45.625488406641125],[16.562833786010742,45.62445296065296],[16.563713550567623,45.623267426545056],[16.563820838928223,45.623132364106546],[16.564185619354248,45.62280221010927],[16.56487226486206,45.62220192513309],[16.565215587615967,45.62191678751781],[16.566460132598877,45.621301485617565],[16.567554473876953,45.62074620737434],[16.568026542663574,45.62043104700609],[16.568498611450195,45.62020593137275],[16.56942129135132,45.61984574447939],[16.570279598236084,45.6191103557209],[16.570472717285156,45.61893025904448],[16.57090187072754,45.61857006395628],[16.57139539718628,45.61799975033449],[16.57165288925171,45.61769958294045],[16.571202278137207,45.61697917463894],[16.569571495056152,45.61670901913971],[16.569335460662842,45.61624374828451],[16.569528579711914,45.61558335721665],[16.569571495056152,45.615058040586334],[16.56961441040039,45.61426255174965],[16.569786071777344,45.614052420738965],[16.570816040039062,45.613422022982796],[16.57216787338257,45.613241908036635],[16.573948860168457,45.613076802161146],[16.576030254364014,45.61321188882268],[16.578240394592285,45.61315185034662],[16.57984972000122,45.61310682144738],[16.580708026885986,45.61312183108447],[16.58160924911499,45.61309181180627],[16.58358335494995,45.61378225113971],[16.584699153900146,45.61382727949664],[16.587982177734375,45.61363215635553]]]}}]}";

    private static final String SMALLER_GEOSHAPE = "{\"type\":\"FeatureCollection\",\"features\":[{\"type\":\"Feature\",\"properties\":{\"stroke\":\"#555555\",\"stroke-width\":2,\"stroke-opacity\":1,\"fill\":\"#555555\",\"fill-opacity\":0.5},\"geometry\":{\"type\":\"Polygon\",\"coordinates\":[[[16.510412693023696,45.859815603122634],[16.589891910552993,45.787322451651534],[16.601865291595477,45.78857932474319],[16.60362482070925,45.78911797596399],[16.603882312774676,45.78965662197942],[16.605427265167254,45.79157176565478],[16.605684757232684,45.792110387956804],[16.605513095855727,45.794504201876144],[16.604740619659438,45.79552154165609],[16.602938175201434,45.796179810440634],[16.60242319107057,45.79665854649084],[16.600964069366473,45.79977023056605],[16.600620746612563,45.802762070613],[16.60070657730104,45.805634085911095],[16.600878238677996,45.80736919007074],[16.600964069366473,45.80802731889003],[16.601564884185805,45.80946320932351],[16.601307392120376,45.81155714985443],[16.601307392120376,45.812693827461615],[16.600534915924086,45.81406977457891],[16.595385074615493,45.81502693513234],[16.591866016387954,45.81406977457891],[16.588604450225844,45.814668001852674],[16.585428714752215,45.81634300403169],[16.58499956130983,45.81771886098886],[16.586029529571547,45.8203508404454],[16.590321063995376,45.82142752345573],[16.59246683120729,45.82178641316565],[16.595985889434832,45.82256399960079],[16.597187519073504,45.824059327605525],[16.597616672515887,45.82561442612487],[16.597101688385028,45.82693024478798],[16.59667253494264,45.82770775937849],[16.595900058746356,45.8284852631088],[16.59555673599245,45.82890391446523],[16.595385074615493,45.8300402379888],[16.59607172012331,45.83111673361205],[16.596758365631118,45.83207360113143],[16.599161624908465,45.83279124097508],[16.599934101104754,45.83548230797369],[16.599590778350848,45.83709688571111],[16.598389148712172,45.83918978712909],[16.597187519073504,45.84038569545306],[16.59444093704225,45.84289701926595],[16.59358263015749,45.84337535380672],[16.588776111602797,45.84373410201337],[16.587917804718032,45.84247847316903],[16.58800363540651,45.841701164920956],[16.58448457717897,45.840266105777346],[16.581909656524676,45.84038569545306],[16.58002138137819,45.84313618705038],[16.579506397247332,45.84433201055031],[16.578476428985613,45.84624527468546],[16.575043201446547,45.848875905428045],[16.57349824905397,45.84995203669283],[16.570236682891863,45.8512672799642],[16.567318439483657,45.848875905428045],[16.561996936798113,45.85078901328227],[16.558392047882094,45.85509326536483],[16.55633211135866,45.85628883182431],[16.552212238311785,45.856647496749865],[16.547920703887954,45.85951673287406],[16.548950672149672,45.862505363067775],[16.544401645660418,45.86441800208355],[16.538565158844012,45.86591220553003],[16.53453111648561,45.86579267073226],[16.52337312698366,45.86352146073798],[16.520626544952407,45.86035356552167],[16.516678333282485,45.85921786101903],[16.510412693023696,45.859815603122634]]]}}]}";

    @Test
    void testTruncateLargeGeoshape() {
        GraphicalSurveySummaryExporter exporter = new GraphicalSurveySummaryExporter();
        String largeCellString = exporter.geoShapeValue(VERY_LARGE_GEOSHAPE);
        assertEquals(SpreadsheetVersion.EXCEL2007.getMaxTextLength(), largeCellString.length());
    }

    @Test
    void testSmallGeoshapeUnmodified() {
        GraphicalSurveySummaryExporter exporter = new GraphicalSurveySummaryExporter();
        String smallerCellString = exporter.geoShapeValue(SMALLER_GEOSHAPE);
        assertEquals(SMALLER_GEOSHAPE.length(), smallerCellString.length());
    }
}
